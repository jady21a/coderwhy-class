# 1 组件使用
## 1.1 创建组件
![[Pasted image 20220921152013.png]]
注意: 组件和页面所在项目根目录名不能以“wx-”为前缀，否则会报错。

新建 component 后 .json 文件中会自动加有以下代码
```json
{
  "component": true,
  "usingComponents": {}
}
```
## 1.2 使用
- 在父组件的. json 文件中注册组件  T
```json
{
  "usingComponents": {
    "a-basic": "/components/a-basic/a-basic"
  }
}
```
	如果子组件需要全局使用就在 app. json 全局注册
	
![[Pasted image 20220921154443.png]]
- 在父组件 wxml中
```html
<!--pages/ee/ee.wxml-->
<text>pages/ee/ee.wxml</text>

<view>
  <a-basic></a-basic>
  <a-basic></a-basic>
  <a-basic></a-basic>
</view>
```
- 子组件的js文件中可以定义数据或逻辑


## 1.3 组件作用域
### 1.3.1 组件对外部页面
- 组件样式默认不能改变外部页面样式 (子不改父)
- 组件内不能使用 id# , 属性, 标签选择器
### 1.3.2 外部页面对组件
- 外部使用标签选择器会改变组件样式
- 外部使用类 /id/属性选择器不会改变组件样式
### 1.3.3 让类选择器可以相互影响
isolated 默认
aplly-shared 父可改子
shared 父子互通
```js
// components/a-basic/a-basic.js
Component({
  options:{
    styleIsolation:"isolated",//default
    styleIsolation:"apply-shared",//父可改子
    styleIsolation:"shared"//父子互通
  },
```


# 2 组件通讯
很多情况下，组件内展示的内容（数据、样式、标签），并不是在组件内写死的，而是由使用者来决定。
![[Pasted image 20220921160432.png]]
## 2.1 properties--传递数据
支持的数据类型
String、Number、Boolean、Object、Array、null（不限制类型）
```js
// pages/ee/ee.js
Page({
  data: {
    cont:"1111"
  },
  })
```
传递的数据可在父的 js-->data 中定义-->wxml 中绑定, 如下 content 的 cont
```html
<!--pages/ee/ee.wxml-->
  <!-- 传递数据 -->
  <a-basic title="aaa" content="{{cont}}"></a-basic>
```

```js
// components/a-basic/a-basic.js
Component({
  properties: {
    title:{
      type:String,
      value:"default title"
    },
    content:{
      type:String,
      value:"default content"
    }
  },
```

```html
<!--components/a-basic/a-basic.wxml-->
<view>{{title}}</view>
<view> {{content }} </view>
```

小程序默认值是 value, vue 的默认值是 default 

## 2.2 externalClasses--传递样式
```html
<!--pages/ee/ee.wxml-->
  <!-- 传递样式 -->
  <a-basic excss="excss"></a-basic>
  <a-basic excss="xx"></a-basic>
```

```css
/* pages/ee/ee.wxss */
.excss{
background-color: orange;
}
.xx{
  background-color: yellow;
}
```

```js
// components/a-basic/a-basic.js
Component({
  externalClasses:["excss"],
})

```

```html
<!--components/a-basic/a-basic.wxml-->
<view class="a excss" >a-basic</view>

<view class="excss">{{title}}</view>
<view> {{content}} </view>
```
## 2.3 methods--传递事件
```html
<!--components/a-basic/a-basic.wxml-->
<button bindtap="sonClick">son click</button>
```

```js
// components/a-basic/a-basic.js
Component({
  methods: {
	  sonClick (){
	    console.log ("son");
			this.triggerEvent ("parentReceived","ccc")
	  }
  }
})
```

```html
<!--pages/ee/ee.wxml-->
  <a-basic bind:parentReceived="parentReceivedClick"></a-basic>
```

```js
// pages/ee/ee.js
Page({
  data: {
    cont:"1111"
  },
    parentReceivedClick(event){
    console.log(event);
    console.log("parentReceived",event.detail);
  },
  })

```

## 2.4 父调子的方法 (函数)
this. selectComponent
### 2.4.1 子拥有的方法
```html
<!--components/a-basic/a-basic.wxml-->
<view class="a excss" bindtap="foo">a-basic {{foo}}</view>
```

```js
Component({
  data:{
    foo:"foo"
  },
  foo(){
    console.log("foo");
    this.setData({
      foo:"vvvv"
    })
  },
  }
})
  
```
### 2.4.2 父调用
```html
<!--pages/ee/ee.wxml-->
  <!-- 父调用子方法 -->
  <a-basic class="parent" bindtap="fooChange"></a-basic>
```

```js
// pages/ee/ee.js
Page({
  fooChange(){
    const parent=this.selectComponent(".parent")
    parent.foo()
  },
```

## 2.5 插槽
外部决定显示的标签等
### 单插槽
#### 子
```html
<!--components/b-slot/b-slot.wxml-->
<text>components/b-slot/b-slot.wxml</text>
<view>
  <view>head</view>
  <view>
    <slot></slot>
  </view>
  <view>foot</view>
</view>
```

#### 父
```json
{
  "usingComponents": {
    "b-slot":"/components/b-slot/b-slot",
  }
}
```

```html
<!--pages/ff/ff.wxml-->
<!-- 单个插槽 -->
  <b-slot>
    <text>hhhhhhhhhhh</text>
  </b-slot>
  <b-slot>
    <image src="/assets/img/21.png" mode="widthFix"></image>
  </b-slot>
```

小程序插槽不支持默认值
解决办法
```html
<!--components/b-slot/b-slot.wxml-->
<text>components/b-slot/b-slot.wxml</text>
<view>
  <view>head</view>
  <view class="content">
    <slot></slot>
  </view>
  <view class="default">default slot</view>

  <view>foot</view>
</view>
```

```css
/* components/b-slot/b-slot.wxss */
.default{
  display: none;
}
.content:empty + .default{
  display: block;
}
```

```html
<!--pages/ff/ff.wxml-->
  <!-- 默认插槽 -->
  <b-slot></b-slot>
```

### 多个插槽
#### 子
```html
<!--components/c-slots/c-slots.wxml-->
<text>components/c-slots/c-slots.wxml</text>
<view class="slots">
  <view class="left">
    <slot name="left"></slot>
  </view>
  <view class="center">
    <slot name="center"></slot>
  </view>
  <view class="right">
    <slot name="right"></slot>
  </view>
</view>
```
注意多插槽需要写options
```js
// components/c-slots/c-slots.js
Component({
  options:{
    multipleSlots:true
  },
})
```

```css
/* components/c-slots/c-slots.wxss */
.slots{
  display: flex;
  justify-content: space-around;
}
```
#### 父
```html
<!--pages/ff/ff.wxml-->
<!-- 多个插槽 -->
  <c-slots>
    <button slot="left" size="mini">aaa</button>
    <view slot="center">bbb</view>
    <button slot="right" size="mini">ccc</button>
  </c-slots>
```
json
```json
{
  "usingComponents": {
    "b-slot":"/components/b-slot/b-slot",
    "c-slots":"/components/c-slots/c-slots"
  }
}
```
## behaviors-->mixin
组件间代码共享
behavior 的 js 文件中可以包含一组属性、数据、生命周期函数和方法；
每个组件可以引用多个 behavior ，behavior 也可以引用其它 behavior ；
### 编写
根目录下新建 behavior 文件夹-->count.js
![[Pasted image 20220921213053.png]]
### 使用
```js
// components/d-behavior/d-behavior.js
import { countBehavior } from "../../behaviors/count"
Component({
  behaviors:[countBehavior]
})

```

```html
<!--components/d-behavior/d-behavior.wxml-->
<view>
  <view>counter:{{counter}}</view>
  <button bindtap="increase">+1</button>
  <button bindtap="decrease">-1</button>
</view>

```


# 组件生命周期


created
网络请求, 初始化数据, 不能获取dom
attached
获取 dom
dettached
回收






---
# 3 练习 tab 组件
![[Pasted image 20220921181352.png]]

## 3.1 直接在页面写


## 3.2 分离为组件
