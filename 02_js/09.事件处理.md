# 事件
如用户点击了某个按钮、用户在输入框里面输入了某个文本、用户鼠标经过了某个位置；

## 事件监听
1. 在 script 中直接监听（很少使用）；
2. DOM 属性，通过元素的 on 来监听事件；
3. 通过 EventTarget 中的 addEventListener 来监听；
![[Pasted image 20220527201700.png]]



## 事件流
在浏览器上对着一个元素点击时，点击的不仅仅是这个元素本身, 还有其父元素等

### 捕获 (了解) capture
从外层到内层监听事件,   早期网景 (Netscape) 公司采用
### 冒泡 (重要) bubble
从最内层依次向外传递,    早期ie 采用

如果点击嵌套内的元素, 会先从外到内捕获, 再由点击元素开始向外冒泡
![[Pasted image 20220527205528.png]]

### 监听过程
1. 捕获阶段（Capturing phase）：事件（从 Window）向下走近元素。
2. 目标阶段（Target phase）：事件到达目标元素。
3. 冒泡阶段（Bubbling phase）：事件从元素上开始冒泡。
![[Pasted image 20220525223323.png]]

- 获取当前的阶段: eventPhase

## event 事件对象 
当一个事件发生时，就会有和这个事件相关的很多信息：如事件类型, 点击位置等

这些信息会被封装到一个 Event 对象中，这个对象由浏览器创建，称之为 event 对象；
### event 获取
event 对象会在传入的事件处理函数（event handler function）回调时，被系统传入；我们可以在回调函数中拿到这个 event 对象；
![[Pasted image 20220527212220.png]]
### 属性和方法
#### 常见属性
-  type：事件的类型； 
-  target：当前事件发生的元素； 
-  currentTarget：当前处理事件的元素； 
-  eventPhase：事件所处的阶段； 
-  offsetX、offsetY：事件发生在元素内的位置； 
-  clientX、clientY：事件发生在客户端内的位置； 
-  pageX、pageY：事件发生在客户端相对于 document 的位置； 
-  screenX、screenY：事件发生相对于屏幕的位置；
![[Pasted image 20220527212121.png]]
#### 常见方法
-  preventDefault：取消事件的默认行为； 
-  stopPropagation：阻止事件的进一步传递（冒泡或者捕获都可以阻止）；
![[Pasted image 20220527213915.png]]
## this (在事件处理中)
在函数中，我们也可以通过 this 来获取当前的发生元素：
因为在浏览器内部，调用 event handler 是绑定到当前的 target 上的
![[Pasted image 20220527214932.png]]
## EventTarget (事件目标)
EventTarget 是一个 DOM 接口，主要用于添加、删除、派发 Event 事件；
所有的节点、元素都继承自 EventTarget, Window 也继承自 EventTarget
-  addEventListener：注册某个事件类型以及事件处理函数； 
-  removeEventListener：移除某个事件类型以及事件处理函数； 
-  dispatchEvent：派发某个事件类型到 EventTarget 上；//派发自定义事件
![[Pasted image 20220527222130.png]]
## 事件委托/代理（event delegation）
当子元素被点击时，父元素可以通过冒泡可以监听到子元素的点击；并且可以通过 event. target 获取到当前监听的元素；
因此可以实现对只父元素监听便可监听到其所有子元素

案例：一个 ul 中存放多个 li，点击某一个 li 会变成红色 
     方案一：监听每一个 li 的点击，并且做出相应； 
     方案二：在 ul 中监听点击，并且通过 event. target 拿到对应的 li 进行处理；
    [506]()
![[Pasted image 20220529000836.png]]
### 委托标记 (data-*) [[2.4 HTML5新增元素]] [[08.DOM2-特性及插入]]
![[Pasted image 20220529100546.png]]

## 常见事件
https://developer.mozilla.org/zh-CN/docs/Web/Events
### ◼ 鼠标事件： 
-  click —— 当鼠标点击一个元素时（触摸屏设备会在点击时生成）。 
-  mouseover / mouseout —— 当鼠标指针移入/离开一个元素时。 
-  mousedown / mouseup —— 当在元素上按下/释放鼠标按钮时。 
-  mousemove —— 当鼠标移动时。
- oncontextmenu----点击右键 
![[Pasted image 20220527200235.png]]

#### mouseover 和 mouseenter 的区别
mouseover 和 mouseout (over&out)
 -  支持冒泡 
 -  进入元素的子元素时
	 1. 父元素 out
	 2. 子元素调用 over (谁的 over?---> 子元素的)
	 3. 因为冒泡, 父元素 over
mouseenter 和 mouseleave  (enter & leave)
-  不支持冒泡 
-  进入子元素依然属于在该元素内，没有任何反应
![[Pasted image 20220530024918.png]]
### ◼ 键盘事件： 
-  keydown 和 keyup —— 当按下和松开一个按键时。 
- press---文本输入

- code: “按键代码”（"KeyA"，"ArrowLeft" 等），特定于键盘上按键的物理位置。
- key: 字符（"A"，"a" 等）

1. 点击搜索和 enter 搜索
2. 按 s 键自动获取焦点
![[Pasted image 20220530224230.png]]
### ◼ 表单（form）元素事件： 
-  onfocus : 聚焦
- onblur: 失焦
- onchange: 表单内容改变触发 ( 失焦时)
- oninput: 输入内容时触发
- onreset: 重置
- submit : 提交
![[Pasted image 20220530225846.png]]

### ◼ Document 事件： 
-  DOMContentLoaded —— 当 HTML 的加载和处理均完成，DOM 被完全构建完成时。 
### ◼ CSS 事件： 
-  transitionend —— 当一个 CSS 动画完成时。


## 文档加载事件
若文档将 script 放在元素标签之前, 则不能获取到元素, 此时用到 onload 便可获取
onload：浏览器不仅加载完成了 HTML，还加载完成了所有外部资源：图片，样式等。
onresize: 监听浏览器窗口大小改变
DOMContentLoaded: 浏览器已完全加载 HTML，并构建了 DOM 树，但像和样式表之类的外部资源可能尚未加载完成。
![[Pasted image 20220530233253.png]]